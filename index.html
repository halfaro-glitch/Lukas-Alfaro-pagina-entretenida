<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dibujo Interactivo con Apertura</title>
<style>
  body {
    background-color: #001100;
    color: #ccffcc;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 20px;
  }

  a.big-link {
    cursor: pointer;
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    max-width: 700px;
    margin: 0 auto;
  }

  a.big-link:hover {
    background-color: #33ff33;
    color: #000;
  }

  .section {
    background: rgba(0,70,0,0.9);
    border-radius: 15px;
    padding: 15px;
    box-shadow: 0 0 15px #00ff00;
    max-width: 700px;
    margin: 0 auto 30px auto;
  }

  #drawing-canvas {
    background: #001100;
    border: 2px solid #00ff00;
    border-radius: 10px;
    cursor: crosshair;
  }

  .draw-controls {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 10px;
    background: #001100;
    border: 2px solid #00ff00;
    border-radius: 12px;
    padding: 8px;
  }

  .draw-controls button {
    background: #003300;
    border: none;
    padding: 8px 12px;
    color: #39ff14;
    cursor: pointer;
    border-radius: 8px;
    box-shadow: 0 0 8px #00ff00;
    font-weight: bold;
  }

  .draw-controls button:hover {
    background: #00ff00;
    color: #000;
  }

  .color-picker {
    width: 40px;
    height: 40px;
    border: 2px solid #00ff00;
    border-radius: 8px;
    cursor: pointer;
  }

  #status {
    margin-top: 10px;
    font-weight: bold;
    color: #99ff99;
  }
</style>
</head>
<body>

<section class="section" aria-labelledby="drawing-title">
  <h2 id="drawing-title">Dibuja aquí (debes activar el dibujo para comenzar)</h2>

  <div class="draw-controls" aria-label="Controles para el área de dibujo">
    <button id="toggleDrawBtn" aria-pressed="false">Habilitar dibujo</button>
    <button id="clearBtn">Borrar dibujo</button>
    <input type="color" id="colorPicker" class="color-picker" title="Selecciona color" value="#39ff14" />
  </div>

  <canvas id="drawing-canvas" width="600" height="400" aria-label="Área de dibujo"></canvas>
  <p id="status">Dibujo deshabilitado</p>
</section>

<script>
  const canvas = document.getElementById('drawing-canvas');
  const ctx = canvas.getContext('2d');
  const toggleDrawBtn = document.getElementById('toggleDrawBtn');
  const clearBtn = document.getElementById('clearBtn');
  const colorPicker = document.getElementById('colorPicker');
  const statusText = document.getElementById('status');

  let drawingEnabled = false;
  let drawing = false;
  let lastX = 0;
  let lastY = 0;
  ctx.strokeStyle = colorPicker.value;
  ctx.lineWidth = 3;
  ctx.lineJoin = 'round';
  ctx.lineCap = 'round';

  function getCoords(e) {
    const rect = canvas.getBoundingClientRect();
    if(e.touches) {
      return [
        e.touches[0].clientX - rect.left,
        e.touches[0].clientY - rect.top
      ];
    } else {
      return [
        e.clientX - rect.left,
        e.clientY - rect.top
      ];
    }
  }

  function startDrawing(e) {
    if(!drawingEnabled) return;
    drawing = true;
    [lastX, lastY] = getCoords(e);
  }

  function draw(e) {
    if(!drawing || !drawingEnabled) return;
    e.preventDefault();
    const [x, y] = getCoords(e);
    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
    ctx.lineTo(x, y);
    ctx.stroke();
    [lastX, lastY] = [x, y];
  }

  function stopDrawing() {
    drawing = false;
    ctx.beginPath();
  }

  toggleDrawBtn.addEventListener('click', () => {
    drawingEnabled = !drawingEnabled;
    toggleDrawBtn.textContent = drawingEnabled ? 'Deshabilitar dibujo' : 'Habilitar dibujo';
    toggleDrawBtn.setAttribute('aria-pressed', drawingEnabled);
    statusText.textContent = drawingEnabled ? 'Dibujo habilitado: ¡puedes dibujar!' : 'Dibujo deshabilitado';
    canvas.style.cursor = drawingEnabled ? 'crosshair' : 'not-allowed';
  });

  clearBtn.addEventListener('click', () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  });

  colorPicker.addEventListener('input', (e) => {
    ctx.strokeStyle = e.target.value;
  });

  canvas.addEventListener('mousedown', startDrawing);
  canvas.addEventListener('touchstart', startDrawing);
  canvas.addEventListener('mousemove', draw);
  canvas.addEventListener('touchmove', draw);
  canvas.addEventListener('mouseup', stopDrawing);
  canvas.addEventListener('mouseout', stopDrawing);
  canvas.addEventListener('touchend', stopDrawing);
  canvas.addEventListener('touchcancel', stopDrawing);
</script>

</body>
</html>
